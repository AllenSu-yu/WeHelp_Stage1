<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>會員系統</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <header><h1>歡迎光臨，請註冊登入系統</h1></header>
    <h2>註冊帳號</h2>
    <div>
        <div class="signup">
            姓名 <input type="text" id="signup-name"/><br/>
            信箱 <input type="text" id="signup-email"/><br/>
            密碼 <input type="password" id="signup-password"><br/>
            <button onclick="signup()">註冊</button>
        </div>
    </div>
    <script>
        async function signup() {
            let name=document.querySelector("#signup-name").value;
            let email=document.querySelector("#signup-email").value;
            let password=document.querySelector("#signup-password").value;
            if (!name||!email|| !password){
                alert("請輸⼊姓名、信箱和密碼")
                // window.location="/ohoh?msg=請輸⼊姓名、信箱和密碼";
                } 
                else{
                    let response=await fetch("/signup",{
                        method:"POST",
                        body:JSON.stringify({"name":name,"email":email,"password":password})
                    });
                    let result=await response.json();
                    if (result.ok){
                        alert("註冊成功");
                        window.location="/";
                    } else if (result.ok === false){
                        alert("重複的電子郵件");
                        window.location="/ohoh?msg=重複的電子郵件";
                    }
                }
                
            }
        

    </script>
    <hr/> 

    <h2>登入系統</h2>
    <div>
        <div class="login">
            信箱 <input type="text" id="login-email"/><br/>
            密碼 <input type="password" id="login-password"><br/>
            <button onclick="login()">登入</button>
        </div>
    </div>
    <script>
        async function login() {
            let email=document.querySelector("#login-email").value;
            let password=document.querySelector("#login-password").value;
            if (!email|| !password){
                alert("請輸⼊信箱和密碼")
                // window.location="/ohoh?msg=請輸⼊信箱和密碼";
                } 
                else{
                    let response=await fetch("/login",{
                        method:"POST",
                        body:JSON.stringify({"email":email,"password":password})
                    });
                    let result=await response.json();
                    if (result.ok){
                        alert("登入成功");
                        window.location="/member";
                    }else{
                        alert("登入失敗")
                        window.location="/ohoh?msg=電子郵件或密碼錯誤";
                    }
                }
                
            }
        

    </script>


</body>
</html>